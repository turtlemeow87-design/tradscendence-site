---
// src/pages/instruments/OM.astro
import BaseLayout from "../../layouts/BaseLayout.astro";
import Divider from "../../components/Divider.astro";

const title = "Octave Mandolin — Tradscendence | Sound Beyond Borders";
const description =
  "Two contrasting performances on octave mandolin — one Celtic-bright, one Turkish-tinged. Warm, resonant tone for melodic lines and driving rhythm. Short videos, story, and moods.";
const canonical = "https://www.soundbeyondborders.com/instruments/OM";

const videos = [
  { id: "v1", label: "More Celtic", type: "video", src: "/media/OM1.mp4" },
  { id: "v2", label: "More Turkish", type: "video", src: "/media/OM2.mp4" },
];
---

<BaseLayout {title} description={description} canonical={canonical}>

  <section class="mx-auto max-w-6xl px-4 py-10 space-y-8">
    <header class="space-y-2">
      <h1 class="font-display text-3xl md:text-4xl">Octave Mandolin</h1>
      <p class="opacity-80 max-w-3xl">
        Is it Celtic? Is it bluegrass? Is it ... Turkish? Sure.
      </p>
    </header>

    <!-- Tabbed Hero Video -->
    <section class="rounded-2xl overflow-hidden frame border border-black/40 bg-black/20">
      <div class="tab-strip px-3 pt-3 sm:px-4 sm:pt-4" role="tablist" aria-label="Choose performance">
        {videos.map((v, i) => (
          <button
            class="tab-button"
            data-tab={v.id}
            role="tab"
            aria-selected={i === 0 ? "true" : "false"}
            aria-controls={`pane-${v.id}`}
            id={`tab-${v.id}`}
          >
            {v.label}
          </button>
        ))}
      </div>

      <div id="video-shell" class="relative w-full bg-black" style="aspect-ratio: var(--ar,16/9);">
        {videos.map((v, i) => (
          <div
            id={`pane-${v.id}`}
            data-pane={v.id}
            role="tabpanel"
            aria-labelledby={`tab-${v.id}`}
            class={`video-pane ${i === 0 ? "is-active" : ""}`}
          >
            {v.type === "video" ? (
              <video class="h-full w-full object-contain" controls playsinline preload="metadata">
                <source src={v.src} />
              </video>
            ) : (
              <div class="placeholder">
                <div class="placeholder-inner">
                  <span class="placeholder-title">Video coming soon</span>
                  <span class="placeholder-sub">Upload your source in this file’s <code>videos[]</code> config.</span>
                </div>
              </div>
            )}
          </div>
        ))}
      </div>
    </section>

    <!-- Story / Description -->
    <section class="prose-block">
      <h2 class="font-display text-2xl md:text-3xl">About this instrument</h2>
      <p class="opacity-80">
        The Octave Mandolin feels both familiar and new every time I play it. With a warmth, depth, and resonance that stand apart from its smaller cousin, it carries the spirit of Celtic and Anatolian traditions alike — melancholic yet restless, wistful yet grounded. It’s equally capable of tender melodic phrasing and bold rhythmic drive that seems to breathe along with the player.
      </p>
      <p>
        In the first video, I highlight its bright, Celtic side. In the second, I lean into its modal, Turkish-inspired phrasing to show just how adaptable it can be.
      </p>

      <Divider />

      <!-- Recommended Moods -->
      <section class="recommended-moods grid md:grid-cols-2 gap-6 items-center py-10">
        <div class="space-y-5 order-1 md:order-2">
          <h2 class="font-display text-2xl md:text-3xl mb-2">
            Recommended
            <span class="moods-title">
              <span class="m1">M</span>
              <span class="m2">o</span>
              <span class="m3">o</span>
              <span class="m4">d</span>
              <span class="m5">s</span>
            </span>
            for this instrument
          </h2>

          <p class="opacity-80 text-base mb-4">
            The Octave Mandolin bridges brightness and depth — perfect for pieces evoking movement, journey, or introspective storytelling.
          </p>

          <ul class="space-y-3">
            {Array(5).fill(0).map((_, i) => (
              <li class="flex items-center justify-between rounded-xl px-3 py-2 frame">
                <span class="font-medium">Coming Soon!</span>
                <button
                  type="button"
                  class="opacity-70 hover:opacity-100 transition"
                  data-audio={`/media/om-mood${i + 1}.m4a`}
                >
                  ▶︎
                </button>
              </li>
            ))}
          </ul>
        </div>

        <figure class="rounded-xl overflow-hidden frame border border-black/40 shadow-soft order-2 md:order-1">
          <img
            src="/media/inst-om.jpg"
            alt="Close-up of Octave Mandolin"
            class="object-cover w-full h-full aspect-[4/3]"
            loading="lazy"
          />
        </figure>
      </section>
    </section>

    <!-- Keep Exploring -->
    <div class="pt-8">
      <a
        href="/instruments"
        class="inline-flex items-center gap-2 font-display text-lg text-[var(--accent-gold)] hover:text-[var(--accent-rosewood)] transition-colors duration-200 group"
      >
        <span>Explore More Instruments</span>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 transform transition-transform duration-300 group-hover:translate-x-1">
          <path d="M5 12h14" /><path d="M13 5l7 7-7 7" />
        </svg>
      </a>
    </div>
  </section>

  <style lang="css">
  .tab-strip{display:flex;flex-wrap:nowrap;gap:.375rem;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;scroll-snap-type:x proximity;scrollbar-width:none;mask-image:linear-gradient(to right,transparent 0,#000 12px,#000 calc(100% - 12px),transparent 100%)}.tab-strip::-webkit-scrollbar{display:none}
  .tab-button{position:relative;flex:0 0 auto;display:inline-flex;align-items:center;justify-content:center;gap:.4ch;min-height:2.2rem;padding:.55rem .9rem;border-radius:.75rem;font-weight:600;line-height:1;white-space:nowrap;min-width:max-content;background:transparent;color:var(--ivory);border:1px solid transparent;transition:transform 160ms ease,background 160ms ease,border-color 160ms ease;outline:none;scroll-snap-align:start}
  .tab-button::after{content:"";position:absolute;left:.9rem;right:.9rem;bottom:-2px;height:2px;background:var(--accent-gold);transform:scaleX(0);transform-origin:left center;transition:transform 220ms ease;opacity:.9;filter:drop-shadow(0 0 6px rgba(194,164,95,.65))}
  .tab-button:hover{transform:translateY(-1px)}.tab-button:hover::after{transform:scaleX(1)}.tab-button[aria-selected="true"]{border-color:rgba(255,255,255,.1);background:rgba(255,255,255,.04);box-shadow:inset 0 0 0 1px rgba(0,0,0,.35)}.tab-button[aria-selected="true"]::after{transform:scaleX(1)}
  #video-shell{position:relative}.video-pane{position:absolute;inset:0;opacity:0;pointer-events:none;transition:opacity 320ms ease;background:#000;display:flex}.video-pane.is-active{opacity:1;pointer-events:auto}
  .recommended-moods img{object-position:center;filter:brightness(.95) contrast(1.05)}.recommended-moods li.frame{background:linear-gradient(to right,rgba(205,127,50,.15),transparent);border-radius:.75rem;position:relative;overflow:hidden}
  .recommended-moods li.frame::before{content:"";position:absolute;inset:0;border-radius:inherit;padding:1px;background:linear-gradient(to right,rgba(205,127,50,.8),transparent);-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:xor;mask-composite:exclude;pointer-events:none}
  .recommended-moods button[data-audio]{font-size:1.5rem;color:var(--accent-gold,#C2A45F);text-shadow:2px 0 var(--bronze,#CD7F32),-2px 0 var(--bronze,#CD7F32),0 2px var(--bronze,#CD7F32),0 -2px var(--bronze,#CD7F32)}
  @media(max-width:768px){.recommended-moods{text-align:center}.recommended-moods ul{max-width:24rem;margin-inline:auto}}
  .moods-title{display:inline-flex;gap:.05ch;margin:0 .25ch;letter-spacing:.015em;line-height:1;font-family:var(--font-display,"Cinzel"),serif;font-weight:600}
  .moods-title span{text-shadow:0 0 6px rgba(0,0,0,.25);mix-blend-mode:soft-light;transition:transform 220ms ease,filter 220ms ease,text-shadow 220ms ease;animation:shimmer 8s ease-in-out infinite}
  .moods-title span:hover{transform:scale(1.07);filter:brightness(1.1);text-shadow:0 0 10px rgba(255,255,255,.25)}
  .m1{color:#2C4C76;animation-delay:0s}.m2{color:#4F6C89;animation-delay:1s}.m3{color:#6B5A7A;animation-delay:2s}.m4{color:#7A4F4B;animation-delay:3s}.m5{color:#6E2A2A;animation-delay:4s}.m3,.m4{filter:saturate(.85)}
  @keyframes shimmer{0%{filter:brightness(1)}50%{filter:brightness(1.1) saturate(1.1)}100%{filter:brightness(1)}}
  </style>

  <script type="module">
  const tablist=document.querySelector('[role="tablist"]');const shell=document.getElementById('video-shell');const buttons=tablist?Array.from(tablist.querySelectorAll('.tab-button')):[];const panes=Array.from(document.querySelectorAll('.video-pane'));const ratioMap=new Map();const setShellRatio=r=>shell?.style.setProperty('--ar',r||'16 / 9');const measure=p=>{const m=p.getAttribute('data-ratio');if(m&&m.includes('/')){ratioMap.set(p.id,m);return}const v=p.querySelector('video');if(v){const f=()=>{const w=v.videoWidth,h=v.videoHeight;if(w&&h)ratioMap.set(p.id,`${w} / ${h}`)};v.readyState>=1?f():v.addEventListener('loadedmetadata',f,{once:!0});return}const i=p.querySelector('iframe');if(i)ratioMap.set(p.id,m||'16 / 9')};panes.forEach(measure);
  const activate=id=>{for(const b of buttons){const s=b.dataset.tab===id;b.setAttribute('aria-selected',s?'true':'false');b.tabIndex=s?0:-1}for(const p of panes){const a=p.dataset.pane===id;p.classList.toggle('is-active',a);if(!a){const v=p.querySelector('video');if(v)v.pause();const i=p.querySelector('iframe');if(i){const s=i.src;i.src=s}}else{const r=ratioMap.get(p.id)||p.getAttribute('data-ratio')||'16 / 9';setShellRatio(r)}}};
  if(tablist){tablist.addEventListener('click',e=>{const b=e.target.closest('.tab-button');if(!b)return;activate(b.dataset.tab)});tablist.addEventListener('keydown',e=>{const i=buttons.findIndex(b=>b.getAttribute('aria-selected')==='true');if(e.key==='ArrowRight'){const n=buttons[(i+1)%buttons.length];n.focus();activate(n.dataset.tab);e.preventDefault()}else if(e.key==='ArrowLeft'){const p=buttons[(i-1+buttons.length)%buttons.length];p.focus();activate(p.dataset.tab);e.preventDefault()}else if(e.key==='Enter'||e.key===' '){const b=document.activeElement;if(b&&b.classList.contains('tab-button')){activate(b.dataset.tab);e.preventDefault()}}})}
  const init=panes.find(p=>p.classList.contains('is-active'))||panes[0];if(init){const a=()=>{const r=ratioMap.get(init.id)||init.getAttribute('data-ratio')||'16 / 9';setShellRatio(r)};const v=init.querySelector('video');v&&!(v.readyState>=1)?v.addEventListener('loadedmetadata',a,{once:!0}):a()}const first=buttons.find(b=>b.getAttribute('aria-selected')==='true')||buttons[0];buttons.forEach(b=>b.tabIndex=b===first?0:-1);
  </script>
</BaseLayout>
